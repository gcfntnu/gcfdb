#-*- mode:snakemake -*-
include:
  'ercc.db'
include:
  'smallrna_calibrators.db'
include:
    'indexes.rules'

FILTER_CONF = config.get('filter')
if FILTER_CONF is None:
   config['filter'] = FILTER_CONF = {}
SPIKE_CONF = FILTER_CONF.get('spikein')
if SPIKE_CONF is None:
   config['filter']['spikein'] = SPIKE_CONF = {}

rule spikein_merged_fasta:
    input:
        join(EXT_DIR, 'ERCC', 'fasta', 'ERCC92.fa'),
        join(EXT_DIR, 'smallrna_calibrators', 'fasta', 'calibrators.dna.fa')
    output:
        join(EXT_DIR, 'merged_spikein', 'fasta', 'merged_spikein.fa')
    shell:
        'cat {input} > {output}'
        

rule spikein_indexes:
    input:
        join(EXT_DIR, 'ERCC', 'index', 'ERCC92', 'bowtie', 'ERCC92.1.ebwt'),
        join(EXT_DIR, 'smallrna_calibrators', 'index', 'calibrators.dna', 'bowtie', 'calibrators.dna.1.ebwt'),
        join(EXT_DIR, 'merged_spikein', 'index', 'merged_spikein', 'bowtie', 'merged_spikein.1.ebwt')
