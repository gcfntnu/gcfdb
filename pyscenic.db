#-*- mode:snakemake -*-
"""pySCENIC Single-Cell rEgulatory Network Inference and Clustering

Auxilary data downloads

https://github.com/aertslab/pySCENIC
"""
ORG = config['organism']
PYSCENIC_EXT = join(DATA_EXT, 'pyscenic', ORG)

MOTIF2TF = {'homo_sapiens': 'https://resources.aertslab.org/cistarget/motif2tf/motifs-v9-nr.hgnc-m0.001-o0.0.tbl',
         'mus_musculus': 'https://resources.aertslab.org/cistarget/motif2tf/motifs-v9-nr.mgi-m0.001-o0.0.tbl'
}

CIS_DB = {'homo_sapiens':' https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg38/refseq_r80/mc9nr/gene_based/hg38__refseq-r80__500bp_up_and_100bp_down_tss.mc9nr.feather',
          'mus_musculus': 'https://resources.aertslab.org/cistarget/databases/mus_musculus/mm10/refseq_r80/mc9nr/gene_based/mm10__refseq-r80__500bp_up_and_100bp_down_tss.mc9nr.feather'}

TF = {'homo_sapiens': 'https://raw.githubusercontent.com/aertslab/pySCENIC/master/resources/hs_hgnc_curated_tfs.txt',
      'mus_musculus': 'https://raw.githubusercontent.com/aertslab/pySCENIC/master/resources/mm_mgi_tfs.txt'}

rule pyscenic_tf:
    params:
        url = TF[ORG]
    output:
        join(PYSCENIC_EXT, 'tfs.txt')
    shell:
        'wget -O - {params.url} -o {log} > {output}'

rule pyscenic_motif_db:
    output:
        join(PYSCENIC_EXT, 'motifs.tbl')
    params:
        url = MOTIF2TF[ORG]
    log:
       join(PYSCENIC_EXT, 'motifs.log') 
    shell:
        'wget -O - {params.url} -o {log} > {output}'
    
rule pyscenic_cis_db:
    output:
        join(PYSCENIC_EXT, 'tss.feather')
    params:
        url = CIS_DB[ORG]
    log:
       join(PYSCENIC_EXT, 'tss.log') 
    shell:
        'wget -O - {params.url} -o {log} > {output}'
